else{
pop[i,2]=999999999
pop[i,3]=111111111
}
}
View(pop)
for (i in 2:length(time)){
if(i = which(pop[i,3]==10000)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rnn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2]=999999999
pop[i,3]=111111111
}
}
for (i in 2:length(time)){
if(i == which(pop[i,3]==10000)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rnn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2]=999999999
pop[i,3]=111111111
}
}
rm(pop)
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
if(i == which(pop[i,3]==10000)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rnn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2]=999999999
pop[i,3]=111111111
}
}
##for (i in 2:length(time)){
#if(i == which(pop[i,3]==10000)){
#   pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
#  pop[i,3] <- pop[i-1,3]+(rnn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
#}
#else{
# pop[i,2]=999999999
#pop[i,3]=111111111
#}
#}
rm(pop)
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rnn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
which(pop[,3]==10000)
which(pop[,3]=10000)
which(pop[,3]==1)
which(pop[,2]==99)
which(pop[,3]==10000)
which(pop[,1]==343)
which(pop[,3]>9999)
which(pop[,3]>9999)[1]
which(pop[,2]+pop[,3]>999999)
which(pop[,2]+pop[,3]>999990)
which(K-(pop[,2]+pop[,3])<10)[1]
plot(pop[,2].pop[,3])
plot(pop[,2],pop[,3])
plot(pop[,1],pop[,3])
rm(pop)
time <- 1:10000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
if(i< which(K-(pop[,2]-pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
which(K-(pop[,2]-pop[,3])<100)[1])
which(K-(pop[,2]-pop[,3])<100)[1]
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
which(K-(pop[,2]-pop[,3])<100)[1]
which(K-(pop[,2]+pop[,3])<100)[1]
rm(pop)
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
if(i< which(K-(pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
which(K-(pop[,2]+pop[,3])<100)[1]
for (i in 2:length(time)){
if(i < (which(K-(pop[,2]+pop[,3])<100)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
rm(pop)
setwd("C:/Users/matth/Desktop/Intro_to_Biocomputing/BioComp_Tutorial13")
time <- 1:10000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
if(i < (which(K-(pop[,2]+pop[,3])<100)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < (which(K-(pop[,2]+pop[,3])<100)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
plot(pop[,1],pop[,2])
rm(pop)
setwd("C:/Users/matth/Desktop/Intro_to_Biocomputing/BioComp_Tutorial13")
time <- 1:10000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
if(i < (which(K-(pop[,2]+pop[,3])<100)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
if(i < (which(pop[,2]+pop[,3]>90000)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
if(i < (which(pop[,2]+pop[,3]>90000)[1])){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
m <- 1:5
which(m<6)
which(m<3)
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
plot(pop[,1],pop[,2])
numbers <- data.frame(pop)
View(numbers)
numbers <- data.frame(pop,ncol=3, colnames=c("Generations","NumberNon","NumberAre"))
numbers <- data.frame(pop,ncol=3)
View(numbers)
numbers <- data.frame(pop,ncol=3
colnames=c("Generations","NumberNon","NumberAre"))
numbers <- data.frame(pop,ncol=3,
colnames=c("Generations","NumberNon","NumberAre"))
numbers <- data.frame(pop,ncol=3)
numbers$1=Generations
numbers$1="Generations"
numbers[,1]="Generations"
rm(pop)
rm(numbers)
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
numbers <- data.frame(pop,ncol=3)
numbers <- data.frame(matrix(pop),ncol=3)
View(pop)
numbers <- data.frame(pop,ncol=3)
numbers <- data.frame(pop)
numbers <- data.frame(pop,colnames=c("Gen","Non","Are"))
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
numbers$POP
numbers$POP <- NA
setwd("C:/Users/matth/Desktop/Intro_to_Biocomputing/BioComp_Tutorial13")
time <- 1:10000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
numbers$POP <- NA
View(numbers)
setwd("C:/Users/matth/Desktop/Intro_to_Biocomputing/BioComp_Tutorial13")
time <- 1:10000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
newnumbers <- data.frame(size=unlist(numbers,use.names=FALSE))
View(newnumbers)
View(numbers)
rm(newnumbers)
newnumbers <- data.frame(size=unlist(c(numbers[,2],numbers[,3]),use.names=FALSE))
View(newnumbers)
newnumbers$population <- rep(c("NonResistant","Resistant"),times=length(numbers))
rep(c("NonResistant","Resistant"),times=length(numbers))
nrows(numbers)
nrow(numbers)
rep(c("NonResistant","Resistant"),times=nrow(numbers))
rep(c("NonResistant","Resistant"),each=length(numbers))
rep(c("NonResistant","Resistant"),each=nrow(numbers))
newnumbers$population <- rep(c("NonResistant","Resistant"),each=nrow(numbers))
newnumbers <- data.frame(generations=numbers[,1],size=unlist(c(numbers[,2],numbers[,3]),use.names=FALSE))
newnumbers$population <- rep(c("NonResistant","Resistant"),each=nrow(numbers))
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()
library(ggplot2)
library(ggplot2)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()
time <- 1:1000
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
newnumbers <- data.frame(generations=numbers[,1],size=unlist(c(numbers[,2],numbers[,3]),use.names=FALSE))
newnumbers$population <- rep(c("NonResistant","Resistant"),each=nrow(numbers))
library(ggplot2)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()
time <- 1:600
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3)
pop[,1] <- 1:length(time)
pop[1,2] <- No
pop[1,3] <- 1
for (i in 2:length(time)){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
newnumbers <- data.frame(generations=numbers[,1],size=unlist(c(numbers[,2],numbers[,3]),use.names=FALSE))
newnumbers$population <- rep(c("NonResistant","Resistant"),each=nrow(numbers))
library(ggplot2)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_spline()
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
stat_spline()
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_smooth()
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_smooth(fullrange=FALSE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_smooth(fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_smooth(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point()+
geom_line(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(size="3")+
geom_line(method="loess",fullrange=TRUE)
geom_point(aes(size="3")+
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(aes(size="3"))+
geom_line(method="loess",fullrange=TRUE)
rm(pop)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(aes(size="3"))+
geom_line(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(aes(size="1"))+
geom_line(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(aes(size="10"))+
geom_line(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(size=1)+
geom_line(method="loess",fullrange=TRUE)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(size=1)+
geom_line(method="loess",size=3)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_point(size=1)+
geom_line(method="loess",size=1.5)
setwd("C:/Users/matth/Desktop/Intro_to_Biocomputing/BioComp_Tutorial13")
#Set conditions
time <- 1:600
rnn <- .1
rnt <- -.1
rmn <- .1
rmt <- .05
K=1000000
No=99
pop <- matrix(data=NA, nrow=length(time),ncol=3) #pre-allocate matrix
pop[,1] <- 1:length(time) #Set generations
pop[1,2] <- No #Set initial non-resistant population size
pop[1,3] <- 1 #Set initial resistant population size
#For some reason I could only get it to work if I did it without treatment first
for (i in 2:length(time)){ #For each generation
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K)) #nonres
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K)) #res
}
for (i in 2:length(time)){
if(i < which(K - (pop[,2]+pop[,3])<100)[1]){#Equilibrium reached within
#100 cells of carrying capacity
#This is considered pre-treatment
pop[i,2] <- pop[i-1,2]+(rnn*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmn*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
else{ #This is post-treatment
pop[i,2] <- pop[i-1,2]+(rnt*pop[i-1,2]*(1-(pop[i-1,2]+pop[i-1,3])/K))
pop[i,3] <- pop[i-1,3]+(rmt*pop[i-1,3]*(1-(pop[i-1,2]+pop[i-1,3])/K))
}
}
#Need a new df to graph it
numbers <- data.frame(Generation=pop[,1],NumberNot=pop[,2],NumberAre=pop[,3])
#Have to put df in "long mode"
newnumbers <- data.frame(generations=numbers[,1],size=unlist(c(numbers[,2],numbers[,3]),use.names=FALSE))
newnumbers$population <- rep(c("NonResistant","Resistant"),each=nrow(numbers))
#Make the graph!
library(ggplot2)
ggplot(data=newnumbers,aes(x=generations,y=size,color=population))+
geom_line(method="loess",size=1.5)
#Viola! Have a great day!
